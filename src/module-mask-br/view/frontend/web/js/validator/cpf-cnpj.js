define(["jquery","Eloom_Core/js/masks"],function(e,n){function k(b){if(""==b)return!1;var a=[6,5,4,3,2,9,8,7,6,5,4,3,2];if(14!=(b=b.replace(/[^\d]/g,"").split("")).length)return!1;for(var c=0,d=0;12>c;d+=b[c]*a[++c]);if(b[12]!=(2>(d%=11)?0:11-d))return!1;for(d=c=0;12>=c;d+=b[c]*a[c++]);return b[13]!=(2>(d%=11)?0:11-d)?!1:!0}function l(b){if(""==b||11!=(b=b.replace(/[^\d]/g,"").split("")).length||(new RegExp("^"+b[0]+"{11}$")).test(b.join("")))return!1;for(var a=10,c=0,d=0;2<=a;c+=b[d++]*a--);if(b[9]!=
(2>(c%=11)?0:11-c))return!1;a=11;for(d=c=0;2<=a;c+=b[d++]*a--);return b[10]!=(2>(c%=11)?0:11-c)?!1:!0}e.fn.cpfcnpj=function(b){var a=e.extend({mask:!1,validate:"cpfcnpj",event:"focusout",handler:e(this),ifValid:null,ifInvalid:null},b);if(a.mask)if(null==e().mask)a.mask=!1;else if("cpf"==a.validate)e(this).mask("000.000.000-00");else if("cnpj"==a.validate)e(this).mask("00.000.000/0000-00");else{var c=e(this),d=["000.000.000-009","00.000.000/0000-00"],h=14<c.val().length?d[1]:d[0];e(this).mask(h,{onKeyPress:function(f){h=
14<f.length?d[1]:d[0];c.mask(h,this)}})}return this.each(function(){var f=null,g=e(this);e(document).on(a.event,a.handler,function(){14==g.val().length||18==g.val().length?"cpf"==a.validate?f=l(g.val()):"cnpj"==a.validate?f=k(g.val()):"cpfcnpj"==a.validate&&(f=l(g.val())?!0:k(g.val())?!0:!1):f=!1;if(e.isFunction(a.ifValid))if(null!=f&&f){if(e.isFunction(a.ifValid)){var m=e.Callbacks();m.add(a.ifValid);m.fire(g)}}else e.isFunction(a.ifInvalid)&&a.ifInvalid(g)})})}});
